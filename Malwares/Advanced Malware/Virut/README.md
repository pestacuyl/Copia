## Virus:W32/Virut
![Windows](https://img.shields.io/badge/Windows-0078D6?style=for-the-badge&logo=windows&logoColor=white) ![Microsoft](https://img.shields.io/badge/Microsoft-0078D4?style=for-the-badge&logo=microsoft&logoColor=white)

### Technical Details

Viruses belonging to this family infect files with .EXE and .SCR extensions. All viruses belonging to the Virut family also contain an IRC-based backdoor that provides unauthorized access to infected computers.

Some Virut variants contain the following text strings:

    O noon of life! O time to celebrate!
    O summer garden!
    Relentlessly happy and expectant, standing: -
    Watching all day and night, for friends I wait:
    Where are you, friends? Come! It is time! It's late!

### Entry Point Obscuring

Virut is a polymorphic appending file infector with EPO (Entry Point Obscuring) capabilities. The virus uses several infection methods:

    Method 1: The virus relocates a certain amount of bytes from the entry point of the original file and writes its initial decryptor there. So when an infected file is run, the virus code gets control first. The initial decryptor then decrypts a small part of the virus's body that is appended to the end of the infected file and passes control to it.
    Method 2: The virus appends its code to the end of the file and changes the entry point address of the original program so it points to the start of the appended viral code, where the decryptor is located. This is the most common way of infecting files for appending parasitic infectors.
    Method 3: The virus writes its initial code into a gap (empty space) in the end of the original file's code section and redirects the entry point address to that code. The initial code decrypts a small part of the virus body and passes control to it. Then the main decryptor takes control and decrypts the rest of the virus body. Once the file is infected, the virus patches the first found API call (from the entry point address) in the original program so that instead of the API, it calls the initial virus decryptor. That decryptor may be located in the end of the code section as said above.

### Activity

The virus checks whether or not it is already active. If it is, then depending on the infection method used, the virus does one of the following:

    Relocates the original file's data back to its place and passes control to it
    Returns control to the original file's entry point address
    Calls the replaced API itself and then passes control to the original program.

If the virus is not yet active, the second decryptor decrypts the rest of the virus body and initiates installation cycle. During the installation cycle, the virus injects its code into a system process, hooks a few low-level Windows API calls and stays resident in memory. When a file with .EXE or .SCR extension is opened or run, the virus tries to infect it with one of its four methods.
Backdoor

The virus contains an IRC-based backdoor. The backdoor connects to the pre-defined IRC server (ircd.zief.pl in the latest variants) and joins the "virtu" channel. The author of the virus can give commands to all or to specific bots created by the virus in the channel. The bot is quite primitive - it allows a hacker to download and run files from Internet.
